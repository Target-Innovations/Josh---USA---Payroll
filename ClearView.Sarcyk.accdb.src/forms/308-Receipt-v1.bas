Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =10212
    DatasheetFontHeight =11
    ItemSuffix =189
    Left =2843
    Top =5063
    Right =12863
    Bottom =7935
    RecSrcDt = Begin
        0x4103b0d4f43ce640
    End
    RecordSource ="Collection-Stub"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Aptos"
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =0
            FontSize =11
            FontName ="Aptos"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =60.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            TextFontFamily =0
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Aptos"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            TextFontFamily =0
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Aptos"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            Height =2834
            Name ="Detail"
            AlternateBackThemeColorIndex =0
            BackThemeColorIndex =0
            Begin
                Begin Rectangle
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =93
                    Width =10212
                    Height =2777
                    Name ="BoxReceipt"
                    LayoutCachedWidth =10212
                    LayoutCachedHeight =2777
                    BackThemeColorIndex =0
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =2
                    Left =908
                    Top =570
                    Width =2723
                    Height =308
                    FontSize =12
                    ForeColor =62207
                    Name ="Label45"
                    Caption ="Union Vending"
                    GroupTable =1
                    LayoutCachedLeft =908
                    LayoutCachedTop =570
                    LayoutCachedWidth =3631
                    LayoutCachedHeight =878
                    LayoutGroup =1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =2
                    Left =3690
                    Top =570
                    Width =2723
                    Height =308
                    FontSize =12
                    ForeColor =62207
                    Name ="Label47"
                    Caption ="Description"
                    GroupTable =1
                    LayoutCachedLeft =3690
                    LayoutCachedTop =570
                    LayoutCachedWidth =6413
                    LayoutCachedHeight =878
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =2
                    Left =6473
                    Top =570
                    Width =2723
                    Height =308
                    FontSize =12
                    ForeColor =62207
                    Name ="Label187"
                    Caption ="Location"
                    GroupTable =1
                    LayoutCachedLeft =6473
                    LayoutCachedTop =570
                    LayoutCachedWidth =9196
                    LayoutCachedHeight =878
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =908
                    Top =938
                    Width =2723
                    Height =315
                    FontSize =14
                    ForeColor =14865828
                    Name ="txtGrossCashSplitLocal"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =908
                    LayoutCachedTop =938
                    LayoutCachedWidth =3631
                    LayoutCachedHeight =1253
                    RowStart =1
                    RowEnd =1
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6473
                    Top =938
                    Width =2723
                    Height =315
                    FontSize =14
                    TabIndex =1
                    ForeColor =14865828
                    Name ="txtGrossCashSplitUV"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =6473
                    LayoutCachedTop =938
                    LayoutCachedWidth =9196
                    LayoutCachedHeight =1253
                    RowStart =1
                    RowEnd =1
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =2
                            Left =3690
                            Top =938
                            Width =2723
                            Height =315
                            FontSize =12
                            ForeColor =62207
                            Name ="Label2"
                            Caption ="Gross Cash Split"
                            GroupTable =1
                            LayoutCachedLeft =3690
                            LayoutCachedTop =938
                            LayoutCachedWidth =6413
                            LayoutCachedHeight =1253
                            RowStart =1
                            RowEnd =1
                            ColumnStart =1
                            ColumnEnd =1
                            LayoutGroup =1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            GroupTable =1
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =908
                    Top =1313
                    Width =2723
                    Height =308
                    FontSize =14
                    TabIndex =2
                    ForeColor =14865828
                    Name ="txtEletronicCollectionsLocal"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =908
                    LayoutCachedTop =1313
                    LayoutCachedWidth =3631
                    LayoutCachedHeight =1621
                    RowStart =2
                    RowEnd =2
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6473
                    Top =1313
                    Width =2723
                    Height =308
                    FontSize =14
                    TabIndex =3
                    ForeColor =14865828
                    Name ="txtEletronicCollectionsUV"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =6473
                    LayoutCachedTop =1313
                    LayoutCachedWidth =9196
                    LayoutCachedHeight =1621
                    RowStart =2
                    RowEnd =2
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =2
                            Left =3690
                            Top =1313
                            Width =2723
                            Height =308
                            FontSize =12
                            ForeColor =62207
                            Name ="Label441"
                            Caption ="Eletronic Collections"
                            GroupTable =1
                            LayoutCachedLeft =3690
                            LayoutCachedTop =1313
                            LayoutCachedWidth =6413
                            LayoutCachedHeight =1621
                            RowStart =2
                            RowEnd =2
                            ColumnStart =1
                            ColumnEnd =1
                            LayoutGroup =1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            GroupTable =1
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =908
                    Top =1680
                    Width =2723
                    Height =315
                    FontSize =14
                    TabIndex =4
                    ForeColor =14865828
                    Name ="txtFeeReembursementLocal"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =908
                    LayoutCachedTop =1680
                    LayoutCachedWidth =3631
                    LayoutCachedHeight =1995
                    RowStart =3
                    RowEnd =3
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6473
                    Top =1680
                    Width =2723
                    Height =315
                    FontSize =14
                    TabIndex =5
                    ForeColor =14865828
                    Name ="txtFeeReembursementUV"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =6473
                    LayoutCachedTop =1680
                    LayoutCachedWidth =9196
                    LayoutCachedHeight =1995
                    RowStart =3
                    RowEnd =3
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =2
                            Left =3690
                            Top =1680
                            Width =2723
                            Height =315
                            FontSize =12
                            ForeColor =62207
                            Name ="Label451"
                            Caption ="Fee Reembursement"
                            GroupTable =1
                            LayoutCachedLeft =3690
                            LayoutCachedTop =1680
                            LayoutCachedWidth =6413
                            LayoutCachedHeight =1995
                            RowStart =3
                            RowEnd =3
                            ColumnStart =1
                            ColumnEnd =1
                            LayoutGroup =1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            GroupTable =1
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =908
                    Top =2055
                    Width =2723
                    Height =308
                    FontSize =14
                    TabIndex =6
                    ForeColor =14865828
                    Name ="txtUnionVendingFeesLocal"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =908
                    LayoutCachedTop =2055
                    LayoutCachedWidth =3631
                    LayoutCachedHeight =2363
                    RowStart =4
                    RowEnd =4
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6473
                    Top =2055
                    Width =2723
                    Height =308
                    FontSize =14
                    TabIndex =7
                    ForeColor =14865828
                    Name ="txtUnionVendingFeesUV"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =6473
                    LayoutCachedTop =2055
                    LayoutCachedWidth =9196
                    LayoutCachedHeight =2363
                    RowStart =4
                    RowEnd =4
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =2
                            Left =3690
                            Top =2055
                            Width =2723
                            Height =308
                            FontSize =12
                            ForeColor =62207
                            Name ="Label463"
                            Caption ="Union Vending Fees"
                            GroupTable =1
                            LayoutCachedLeft =3690
                            LayoutCachedTop =2055
                            LayoutCachedWidth =6413
                            LayoutCachedHeight =2363
                            RowStart =4
                            RowEnd =4
                            ColumnStart =1
                            ColumnEnd =1
                            LayoutGroup =1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            GroupTable =1
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =908
                    Top =2423
                    Width =2723
                    Height =308
                    FontSize =14
                    TabIndex =8
                    ForeColor =14865828
                    Name ="txtAdjustedCashSplitLocal"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =908
                    LayoutCachedTop =2423
                    LayoutCachedWidth =3631
                    LayoutCachedHeight =2731
                    RowStart =5
                    RowEnd =5
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6473
                    Top =2423
                    Width =2723
                    Height =308
                    FontSize =14
                    TabIndex =9
                    ForeColor =14865828
                    Name ="txtAdjustedCashSplitUV"
                    Format ="$#,##0.00;-$#,##0.00"
                    GroupTable =1

                    LayoutCachedLeft =6473
                    LayoutCachedTop =2423
                    LayoutCachedWidth =9196
                    LayoutCachedHeight =2731
                    RowStart =5
                    RowEnd =5
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =1
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =1
                    CurrencySymbol ="$"
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =2
                            Left =3690
                            Top =2423
                            Width =2723
                            Height =308
                            FontSize =12
                            ForeColor =62207
                            Name ="Label471"
                            Caption ="Adjusted Cash Split"
                            GroupTable =1
                            LayoutCachedLeft =3690
                            LayoutCachedTop =2423
                            LayoutCachedWidth =6413
                            LayoutCachedHeight =2731
                            RowStart =5
                            RowEnd =5
                            ColumnStart =1
                            ColumnEnd =1
                            LayoutGroup =1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            GroupTable =1
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Dim oStub As New cCollectionStub
' Dim oCollection As New cCollection

Private Sub Form_Current()

    If IsNull(Me.Id) Then Exit Sub
    
    oStub.GetStubInfoById Nz(Me.Id)
    
    Me.txtGrossCashSplitUV = oStub.GrossCashSplit(cSysSettings.UnionVendingId)
    Me.txtGrossCashSplitLocal = oStub.GrossCashSplit(Nz(Me.LocationId))

    Me.txtEletronicCollectionsUV = oStub.SplitElectronicPayments(Nz(Me.LocationId)) * -1
    Me.txtEletronicCollectionsLocal = oStub.SplitElectronicPayments(Nz(Me.LocationId))
    
    ' Why???
'    Me.txtFeeReembursementUV = oStub.FeeReimbursement(cSysSettings.UnionVendingId)
'    Me.txtFeeReembursementLocal = oStub.FeeReimbursement(Nz(Me.LocationId))

    Me.txtFeeReembursementUV = oStub.FeeReimbursement(Nz(Me.LocationId))
    Me.txtFeeReembursementLocal = oStub.FeeReimbursement(Nz(Me.LocationId)) * -1
    
    Me.txtUnionVendingFeesUV = oStub.FeeChargedToLocation
    Me.txtUnionVendingFeesLocal = oStub.FeeChargedToLocation * -1
    
    Me.txtAdjustedCashSplitUV = oStub.CashToLocation
    Me.txtAdjustedCashSplitLocal = oStub.CashToUnionVending
    
    Me.Repaint
    
End Sub


Public Sub RunCollectionsUnitTest()

    Dim oCollection As New cCollectionStub
    
    cSysSettings.InitEnvironmentVariables
    oCollection.GetStubInfoById 1
    
    Debug.Print oCollection.TotalCollected
    Debug.Print oCollection.SplitedServiceFee
    
    Debug.Print "CashAfterSplitFees Local: ", oCollection.CashAfterSplitFees(4)
    Debug.Print "CashAfterSplitFees UV: ", oCollection.CashAfterSplitFees(1)
    
    Debug.Print oCollection.FeeChargedToLocation
    
    Debug.Print "CashAfterFeesCharged Local: ", oCollection.CashAfterFeesCharged(4)
    Debug.Print "CashAfterFeesCharged UV: ", oCollection.CashAfterFeesCharged(1)
    
    Debug.Print "SplitElectronicPayments Local: ", oCollection.SplitElectronicPayments(4)
    Debug.Print "SplitElectronicPayments UV: ", oCollection.SplitElectronicPayments(1)
    
    Debug.Print oCollection.CashToLocation
    Debug.Print oCollection.CashToUnionVending
    Debug.Print oCollection.SplitedServiceFee

End Sub
